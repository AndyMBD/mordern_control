```python
import numpy as np
# Motor  param
#Ld H
Ld=0.212*10^3
#Lq H
Lq=0.26*10^-3
#Psif Vs
Psif=0.375
#Rs ohm
Rs=0.011
#Udc V
Udc=115
#I_max A
I_max=285
#T_max Nm
T_max=100
#Speed_max r/min
Speed_max=6000
#P_max W 
P_max=15*10^3
#J Kg*m^2
j=0.003
#F N*m*s
F=0.001
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    Cell In [2], line 4
          1 import numpy as np
          2 # Motor  param
          3 #Ld H
    ----> 4 Ld=0.212*10^3
          5 #Lq H
          6 Lq=0.26*10^-3
    

    TypeError: unsupported operand type(s) for ^: 'float' and 'int'



```python
import numpy as np
3/2*np.sin(np.pi/3)
np.cos(np.deg2rad(120))
```




    -0.4999999999999998




```python
# %matplotlib inline
# Libraries
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import animation, rc
import matplotlib.patches as patches
import math
# from IPython.display import HTML
import matplotlib
matplotlib.use('TkAgg') # works good outside jupyter note book restart kernal first
# Necessary Parameters for angular Motion
#创建figure窗口，figsize设置窗口的大小
# fig, ax = plt.figure()
# fig, ax = plt.subplots()#figsize = (8.0,8.0)
fig, ax_u_l = plt.subplots(
    ncols=1,
    # sharey=True,
    # figsize=(6, 2),
    figsize=(8, 8),
    # gridspec_kw=dict(width_ratios=[1, 3], wspace=0),
)
freq=20e3
Ts=1/freq
U_dc=12
U_m=2/3*U_dc
# ax=fig.subplots()
# ax.set_xlim=(-2.5,2.5)
# ax.set_ylim=(-2.5,2.5)
#######Draw a Circle#######################
theta_1=np.linspace(0,2*np.pi,100)
theta_1_x=U_dc*np.cos(theta_1)
theta_1_y=U_dc*np.sin(theta_1)
ax_u_l.plot(theta_1_x,theta_1_y)
ax_u_l.set_xlim(-U_dc*1.2,U_dc*1.2)
ax_u_l.set_ylim(-U_dc*1.2,U_dc*1.2)
###Draw a Hexagon ############
theta=np.linspace(0,2*np.pi,7)
# theta_len=np.size(theta)
theta_x=U_dc*np.cos(theta)
theta_y=U_dc*np.sin(theta)
# theta_rad_2=math.radians(theta_2)
# ax_u_r.plot(center[:,0], center[:,1])#, color='r'
###Draw a Hexagon ############
ax_u_l.plot(theta_x, theta_y)#, color='r'
ax_u_l.plot([0,theta_x[0]],[0, theta_y[0]])#[0,0],, color='r'
ax_u_l.annotate('0[100]4', xy=(theta_x[0], theta_y[0]), xytext=(theta_x[0], theta_y[0]))
            # arrowprops=dict(facecolor='black', shrink=0.05),
ax_u_l.plot([0,theta_x[1]],[0, theta_y[1]])#[0,0],, color='r'
ax_u_l.annotate('$\pi/3$[110]6', xy=(theta_x[1], theta_y[1]), xytext=(theta_x[1], theta_y[1]))

ax_u_l.plot([0,theta_x[2]],[0, theta_y[2]])#[0,0],, color='r'
ax_u_l.annotate('$2\pi/3$[010]2', xy=(theta_x[2], theta_y[2]), xytext=(theta_x[2], theta_y[2]))

ax_u_l.plot([0,theta_x[3]],[0, theta_y[3]])#[0,0],, color='r'
ax_u_l.annotate('$\pi$[011]3', xy=(theta_x[3], theta_y[3]), xytext=(theta_x[3], theta_y[3]))

ax_u_l.plot([0,theta_x[4]],[0, theta_y[4]])#[0,0],, color='r'
ax_u_l.annotate('$4\pi/3$[001]1', xy=(theta_x[4], theta_y[4]), xytext=(theta_x[4], theta_y[4]))

ax_u_l.plot([0,theta_x[5]],[0, theta_y[5]])#[0,0],, color='r'
ax_u_l.annotate('$5\pi/3$[101]5', xy=(theta_x[5], theta_y[5]), xytext=(theta_x[5], theta_y[5]))

# x = np.linspace(0, 2 * np.pi, 50)
# ax_u_l.plot(U_m*np.cos(x), U_m*np.sin(x), lw=0.3)#, "k"

#设置坐标轴刻度
# my_x_ticks = np.linspace(-2, 2, 10)
# #对比范围和名称的区别
# #my_x_ticks = np.arange(-5, 2, 0.5)
# my_y_ticks = np.linspace(-2, 2, 10)
# ax_u_l.set_xticks(my_x_ticks)
# ax_u_l.set_yticks(my_x_ticks)
# plt.xticks()
# plt.yticks(my_y_ticks)
# ax_u_l.plot(theta_x,theta_y)
theta_deg=40
theta_radian =np.deg2rad(theta_deg) #1/12*np.pi#0##2/3*np.pi #np.linspace(0, 2 * np.pi, 50)
# theta_radian =41/24*np.pi #1/12*np.pi#0##2/3*np.pi #np.linspace(0, 2 * np.pi, 50)

U_alpha =   U_m*np.cos(theta_radian)
U_beta  =   U_m*np.sin(theta_radian)
U_S_x   =   U_dc*np.cos(theta_radian)
U_S_y   =   U_dc*np.sin(theta_radian)
U_A_x   =   U_m*np.cos(theta_radian)
U_A_y   =   0
U_B_x   =   U_m*np.cos(2/3*np.pi)*np.cos(theta_radian-2/3*np.pi)
U_B_y   =   U_m*np.sin(2/3*np.pi)*np.cos(theta_radian-2/3*np.pi)
U_C_x   =   U_m*np.cos(4/3*np.pi)*np.cos(theta_radian+2/3*np.pi)
U_C_y   =   U_m*np.sin(4/3*np.pi)*np.cos(theta_radian+2/3*np.pi)
#########Calculate N from U_alpha U_beta#####################################
U_ref1=U_beta
U_ref2=np.sqrt(3)/2*U_alpha-1/2*U_beta
U_ref3=-np.sqrt(3)/2*U_alpha-1/2*U_beta
if U_ref1>0:
    A = 1
else :
    A = 0
if U_ref2>0:
     B = 1
else :
     B = 0
if U_ref3>0:
    C = 1
else :
     C = 0
N=4*C+2*B+A
print("N = ",N)
T_x = np.sqrt(3)*Ts*U_beta/U_dc
T_y = np.sqrt(3)*Ts*(np.sqrt(3)/2*U_alpha+1/2*U_beta)/U_dc
T_z = np.sqrt(3)*Ts*(-np.sqrt(3)/2*U_alpha+1/2*U_beta)/U_dc
# sector=math.ceil(theta_radian/(1/3*np.pi))# up 
sector=int(theta_radian/(1/3*np.pi)+1)# up
print("sector = ",sector)
match sector:
    case 1:#Sector 1 N 3
        ####Sector 4-6 ####
        T_1_temp=-T_z
        T_2_temp=T_x
        if (T_1_temp+T_2_temp)>Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2

        U_4_start_x=0
        U_4_start_y=0
        U_4_end_x=T_1/Ts*2/3*U_dc*np.cos(0)
        U_4_end_y=T_1/Ts*2/3*U_dc*np.sin(0)
        U_6_start_x=0
        U_6_start_y=0
        U_6_end_x=T_2/Ts*2/3*U_dc*np.cos(1/3*np.pi)
        U_6_end_y=T_2/Ts*2/3*U_dc*np.sin(1/3*np.pi)

        U_4_2_Us_start_x=U_4_end_x
        U_4_2_Us_start_y=U_4_end_y
        U_4_2_Us_end_dx=U_6_end_x
        U_4_2_Us_end_dy=U_6_end_y

        U_6_2_Us_start_x=U_6_end_x
        U_6_2_Us_start_y=U_6_end_y
        U_6_2_Us_end_dx=U_4_end_x
        U_6_2_Us_end_dy=U_4_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_4_end_x+U_6_end_x
        U_S_m_end_y=U_4_end_y+U_6_end_y

        # U_4      = ax_u_l.add_patch(plt.Arrow(U_4_start_x,U_4_start_y,U_4_end_x,U_4_end_y, width = 0.05, color = 'b'))
        # U_6      = ax_u_l.add_patch(plt.Arrow(U_6_start_x,U_6_start_y,U_6_end_x,U_6_end_y, width = 0.05, color = 'b'))
        # U_4_2_Us = ax_u_l.add_patch(plt.Arrow(U_4_2_Us_start_x,U_4_2_Us_start_y,U_4_2_Us_end_dx,U_4_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_6_2_Us = ax_u_l.add_patch(plt.Arrow(U_6_2_Us_start_x,U_6_2_Us_start_y,U_6_2_Us_end_dx,U_6_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        U_a_phase      = ax_u_l.add_patch(plt.Arrow(U_4_start_x,U_4_start_y,U_4_end_x,U_4_end_y, width = 0.05, color = 'b'))
        U_c_phase      = ax_u_l.add_patch(plt.Arrow(U_6_start_x,U_6_start_y,U_6_end_x,U_6_end_y, width = 0.05, color = 'b'))
        U_a_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_4_2_Us_start_x,U_4_2_Us_start_y,U_4_2_Us_end_dx,U_4_2_Us_end_dy, width = 0.05, color = 'b'))
        U_c_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_6_2_Us_start_x,U_6_2_Us_start_y,U_6_2_Us_end_dx,U_6_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)
        print("U_4 = ",T_1*2/3*U_dc)
    case 2:#Sector 2 N 1
        ####Sector 6-2 ####
        T_1_temp = T_y
        T_2_temp = T_z
        if (T_1_temp+T_2_temp)>Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2
        U_6_start_x=0
        U_6_start_y=0
        U_6_end_x=T_1/Ts*2/3*U_dc*np.cos(1/3*np.pi)
        U_6_end_y=T_1/Ts*2/3*U_dc*np.sin(1/3*np.pi)
        U_2_start_x=0
        U_2_start_y=0
        U_2_end_x=T_2/Ts*2/3*U_dc*np.cos(2/3*np.pi)
        U_2_end_y=T_2/Ts*2/3*U_dc*np.sin(2/3*np.pi)

        U_6_2_Us_start_x=U_6_end_x
        U_6_2_Us_start_y=U_6_end_y
        U_6_2_Us_end_dx=U_2_end_x
        U_6_2_Us_end_dy=U_2_end_y

        U_2_2_Us_start_x=U_2_end_x
        U_2_2_Us_start_y=U_2_end_y
        U_2_2_Us_end_dx=U_6_end_x
        U_2_2_Us_end_dy=U_6_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_6_end_x+U_2_end_x
        U_S_m_end_y=U_6_end_y+U_2_end_y

        # U_6      = ax_u_l.add_patch(plt.Arrow(U_6_start_x,U_6_start_y,U_6_end_x,U_6_end_y, width = 0.05, color = 'b'))
        # U_2      = ax_u_l.add_patch(plt.Arrow(U_2_start_x,U_2_start_y,U_2_end_x,U_2_end_y, width = 0.05, color = 'b'))
        # U_6_2_Us = ax_u_l.add_patch(plt.Arrow(U_6_2_Us_start_x,U_6_2_Us_start_y,U_6_2_Us_end_dx,U_6_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_2_2_Us = ax_u_l.add_patch(plt.Arrow(U_2_2_Us_start_x,U_2_2_Us_start_y,U_2_2_Us_end_dx,U_2_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        U_c_phase      = ax_u_l.add_patch(plt.Arrow(U_6_start_x,U_6_start_y,U_6_end_x,U_6_end_y, width = 0.05, color = 'b'))
        U_b_phase      = ax_u_l.add_patch(plt.Arrow(U_2_start_x,U_2_start_y,U_2_end_x,U_2_end_y, width = 0.05, color = 'b'))
        U_c_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_6_2_Us_start_x,U_6_2_Us_start_y,U_6_2_Us_end_dx,U_6_2_Us_end_dy, width = 0.05, color = 'b'))
        U_b_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_2_2_Us_start_x,U_2_2_Us_start_y,U_2_2_Us_end_dx,U_2_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)
    case 3:#Sector 3 N 5
        ####Sector 2-3 ####
        T_1_temp = T_x
        T_2_temp = -T_y
        if (T_1_temp+T_2_temp)>Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2
        U_2_start_x=0
        U_2_start_y=0
        U_2_end_x=T_1/Ts*2/3*U_dc*np.cos(2/3*np.pi)
        U_2_end_y=T_1/Ts*2/3*U_dc*np.sin(2/3*np.pi)
        U_3_start_x=0
        U_3_start_y=0
        U_3_end_x=T_2/Ts*2/3*U_dc*np.cos(np.pi)
        U_3_end_y=T_2/Ts*2/3*U_dc*np.sin(np.pi)

        U_2_2_Us_start_x=U_2_end_x
        U_2_2_Us_start_y=U_2_end_y
        U_2_2_Us_end_dx=U_3_end_x
        U_2_2_Us_end_dy=U_3_end_y

        U_3_2_Us_start_x=U_3_end_x
        U_3_2_Us_start_y=U_3_end_y
        U_3_2_Us_end_dx=U_2_end_x
        U_3_2_Us_end_dy=U_2_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_2_end_x+U_3_end_x
        U_S_m_end_y=U_2_end_y+U_3_end_y

        # U_2      = ax_u_l.add_patch(plt.Arrow(U_2_start_x,U_2_start_y,U_2_end_x,U_2_end_y, width = 0.05, color = 'b'))
        # U_3      = ax_u_l.add_patch(plt.Arrow(U_3_start_x,U_3_start_y,U_3_end_x,U_3_end_y, width = 0.05, color = 'b'))
        # U_2_2_Us = ax_u_l.add_patch(plt.Arrow(U_2_2_Us_start_x,U_2_2_Us_start_y,U_2_2_Us_end_dx,U_2_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_3_2_Us = ax_u_l.add_patch(plt.Arrow(U_3_2_Us_start_x,U_3_2_Us_start_y,U_3_2_Us_end_dx,U_3_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        # U_c_phase
        U_b_phase      = ax_u_l.add_patch(plt.Arrow(U_2_start_x,U_2_start_y,U_2_end_x,U_2_end_y, width = 0.05, color = 'b'))
        U_a_phase      = ax_u_l.add_patch(plt.Arrow(U_3_start_x,U_3_start_y,U_3_end_x,U_3_end_y, width = 0.05, color = 'b'))
        U_b_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_2_2_Us_start_x,U_2_2_Us_start_y,U_2_2_Us_end_dx,U_2_2_Us_end_dy, width = 0.05, color = 'b'))
        U_a_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_3_2_Us_start_x,U_3_2_Us_start_y,U_3_2_Us_end_dx,U_3_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)

    case 4:#Sector 4 N 4
        ####Sector 3-1 ####
        T_1_temp = T_z
        T_2_temp = -T_x
        if (T_1_temp+T_2_temp)>Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2

        U_3_start_x=0
        U_3_start_y=0
        U_3_end_x=T_1/Ts*2/3*U_dc*np.cos(3/3*np.pi)
        U_3_end_y=T_1/Ts*2/3*U_dc*np.sin(3/3*np.pi)
        U_1_start_x=0
        U_1_start_y=0
        U_1_end_x=T_2/Ts*2/3*U_dc*np.cos(4/3*np.pi)
        U_1_end_y=T_2/Ts*2/3*U_dc*np.sin(4/3*np.pi)

        U_3_2_Us_start_x=U_3_end_x
        U_3_2_Us_start_y=U_3_end_y
        U_3_2_Us_end_dx=U_1_end_x
        U_3_2_Us_end_dy=U_1_end_y

        U_1_2_Us_start_x=U_1_end_x
        U_1_2_Us_start_y=U_1_end_y
        U_1_2_Us_end_dx=U_3_end_x
        U_1_2_Us_end_dy=U_3_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_3_end_x+U_1_end_x
        U_S_m_end_y=U_3_end_y+U_1_end_y
        
        # U_3      = ax_u_l.add_patch(plt.Arrow(U_3_start_x,U_3_start_y,U_3_end_x,U_3_end_y, width = 0.05, color = 'b'))
        # U_1      = ax_u_l.add_patch(plt.Arrow(U_1_start_x,U_1_start_y,U_1_end_x,U_1_end_y, width = 0.05, color = 'b'))
        # U_3_2_Us = ax_u_l.add_patch(plt.Arrow(U_3_2_Us_start_x,U_3_2_Us_start_y,U_3_2_Us_end_dx,U_3_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_1_2_Us = ax_u_l.add_patch(plt.Arrow(U_1_2_Us_start_x,U_1_2_Us_start_y,U_1_2_Us_end_dx,U_1_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        U_a_phase      = ax_u_l.add_patch(plt.Arrow(U_3_start_x,U_3_start_y,U_3_end_x,U_3_end_y, width = 0.05, color = 'b'))
        U_b_phase      = ax_u_l.add_patch(plt.Arrow(U_1_start_x,U_1_start_y,U_1_end_x,U_1_end_y, width = 0.05, color = 'b'))
        U_a_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_3_2_Us_start_x,U_3_2_Us_start_y,U_3_2_Us_end_dx,U_3_2_Us_end_dy, width = 0.05, color = 'b'))
        U_b_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_1_2_Us_start_x,U_1_2_Us_start_y,U_1_2_Us_end_dx,U_1_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)

    case 5:#Sector 5 N 6
        ####Sector 1-5 ####
        T_1_temp = -T_y
        T_2_temp = -T_z
        if (T_1_temp+T_2_temp)>Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2

        U_1_start_x=0
        U_1_start_y=0
        U_1_end_x=T_1/Ts*2/3*U_dc*np.cos(4/3*np.pi)
        U_1_end_y=T_1/Ts*2/3*U_dc*np.sin(4/3*np.pi)
        U_5_start_x=0
        U_5_start_y=0
        U_5_end_x=T_2/Ts*2/3*U_dc*np.cos(5/3*np.pi)
        U_5_end_y=T_2/Ts*2/3*U_dc*np.sin(5/3*np.pi)

        U_1_2_Us_start_x=U_1_end_x
        U_1_2_Us_start_y=U_1_end_y
        U_1_2_Us_end_dx=U_5_end_x
        U_1_2_Us_end_dy=U_5_end_y

        U_5_2_Us_start_x=U_5_end_x
        U_5_2_Us_start_y=U_5_end_y
        U_5_2_Us_end_dx=U_1_end_x
        U_5_2_Us_end_dy=U_1_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_1_end_x+U_5_end_x
        U_S_m_end_y=U_1_end_y+U_5_end_y
        
        # U_1      = ax_u_l.add_patch(plt.Arrow(U_1_start_x,U_1_start_y,U_1_end_x,U_1_end_y, width = 0.05, color = 'b'))
        # U_5      = ax_u_l.add_patch(plt.Arrow(U_5_start_x,U_5_start_y,U_5_end_x,U_5_end_y, width = 0.05, color = 'b'))
        # U_1_2_Us = ax_u_l.add_patch(plt.Arrow(U_1_2_Us_start_x,U_1_2_Us_start_y,U_1_2_Us_end_dx,U_1_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_5_2_Us = ax_u_l.add_patch(plt.Arrow(U_5_2_Us_start_x,U_5_2_Us_start_y,U_5_2_Us_end_dx,U_5_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        U_c_phase      = ax_u_l.add_patch(plt.Arrow(U_1_start_x,U_1_start_y,U_1_end_x,U_1_end_y, width = 0.05, color = 'b'))
        U_b_phase      = ax_u_l.add_patch(plt.Arrow(U_5_start_x,U_5_start_y,U_5_end_x,U_5_end_y, width = 0.05, color = 'b'))
        U_c_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_1_2_Us_start_x,U_1_2_Us_start_y,U_1_2_Us_end_dx,U_1_2_Us_end_dy, width = 0.05, color = 'b'))
        U_b_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_5_2_Us_start_x,U_5_2_Us_start_y,U_5_2_Us_end_dx,U_5_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)
    
    case 6:#Sector 6 N 2
        ####Sector 5-4 ####
        T_1_temp =-T_x 
        T_2_temp = T_y
        if (T_1_temp+T_2_temp)>=Ts:
            T_1 = T_1_temp/(T_1_temp+T_2_temp)*Ts
            T_2 = T_2_temp/(T_1_temp+T_2_temp)*Ts
        else :
            T_1 = T_1_temp
            T_2 = T_2_temp
        T_0 = Ts-T_1-T_2
        U_5_start_x=0
        U_5_start_y=0
        U_5_end_x=T_1/Ts*2/3*U_dc*np.cos(5/3*np.pi)
        U_5_end_y=T_1/Ts*2/3*U_dc*np.sin(5/3*np.pi)
        U_4_start_x=0
        U_4_start_y=0
        U_4_end_x=T_2/Ts*2/3*U_dc*np.cos(6/3*np.pi)
        U_4_end_y=T_2/Ts*2/3*U_dc*np.sin(6/3*np.pi)

        U_5_2_Us_start_x=U_5_end_x
        U_5_2_Us_start_y=U_5_end_y
        U_5_2_Us_end_dx=U_4_end_x
        U_5_2_Us_end_dy=U_4_end_y

        U_4_2_Us_start_x=U_4_end_x
        U_4_2_Us_start_y=U_4_end_y
        U_4_2_Us_end_dx=U_5_end_x
        U_4_2_Us_end_dy=U_5_end_y

        U_S_m_start_x=0
        U_S_m_start_y=0
        U_S_m_end_x=U_5_end_x+U_4_end_x
        U_S_m_end_y=U_5_end_y+U_4_end_y

        # U_5      = ax_u_l.add_patch(plt.Arrow(U_5_start_x,U_5_start_y,U_5_end_x,U_5_end_y, width = 0.05, color = 'b'))
        # U_4      = ax_u_l.add_patch(plt.Arrow(U_4_start_x,U_4_start_y,U_4_end_x,U_4_end_y, width = 0.05, color = 'b'))
        # U_5_2_Us = ax_u_l.add_patch(plt.Arrow(U_5_2_Us_start_x,U_5_2_Us_start_y,U_5_2_Us_end_dx,U_5_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_4_2_Us = ax_u_l.add_patch(plt.Arrow(U_4_2_Us_start_x,U_4_2_Us_start_y,U_4_2_Us_end_dx,U_4_2_Us_end_dy, width = 0.05, color = 'b'))
        # U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        
        U_b_phase      = ax_u_l.add_patch(plt.Arrow(U_5_start_x,U_5_start_y,U_5_end_x,U_5_end_y, width = 0.05, color = 'b'))
        U_a_phase      = ax_u_l.add_patch(plt.Arrow(U_4_start_x,U_4_start_y,U_4_end_x,U_4_end_y, width = 0.05, color = 'b'))
        U_b_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_5_2_Us_start_x,U_5_2_Us_start_y,U_5_2_Us_end_dx,U_5_2_Us_end_dy, width = 0.05, color = 'b'))
        U_a_phase_2_Us = ax_u_l.add_patch(plt.Arrow(U_4_2_Us_start_x,U_4_2_Us_start_y,U_4_2_Us_end_dx,U_4_2_Us_end_dy, width = 0.05, color = 'b'))
        U_S_m    = ax_u_l.add_patch(plt.Arrow(U_S_m_start_x,U_S_m_start_y,U_S_m_end_x,U_S_m_end_y, width = 0.05, color = 'b'))
        print("T_1_temp = ",T_1_temp)
        print("T_2_temp = ",T_2_temp)
        print("T_1 = ",T_1)
        print("T_2 = ",T_2)
        print("T_0 = ",T_0)
# print("T_x = ",T_x)
# print("T_y = ",T_y)
# print("T_z = ",T_z)
# U_alpha_Start_x     =   0
# U_alpha_Start_y     =   0
# U_alpha_End_x       =   U_alpha
# U_alpha_End_y       =   0

# U_beta_Start_x      =   0
# U_beta_Start_y      =   0
# U_beta_End_x        =   0
# U_beta_End_y        =   U_beta

# U_S_Start_x =   0
# U_S_Start_y =   0
# U_S_End_x   =   U_S_x
# U_S_End_y   =   U_S_y

# U_A_Start_x =   0
# U_A_Start_y =   0
# U_A_End_x   =   U_A_x
# U_A_End_y   =   U_A_y

# U_B_Start_x =   0
# U_B_Start_y =   0
# U_B_End_x   =   U_B_x
# U_B_End_y   =   U_B_y

# U_C_Start_x =   0
# U_C_Start_y =   0
# U_C_End_x   =   U_C_x
# U_C_End_y   =   U_C_y

# U_A_2_U_B_Start_x   = U_A_End_x
# U_A_2_U_B_Start_y   = U_A_End_y
# U_A_2_U_B_End_dx     = U_B_End_x
# U_A_2_U_B_End_dy     = U_B_End_y

# U_B_2_U_C_Start_x   = U_A_2_U_B_Start_x + U_A_2_U_B_End_dx
# U_B_2_U_C_Start_y   = U_A_2_U_B_Start_y + U_A_2_U_B_End_dy
# U_B_2_U_C_End_dx     = U_C_End_x
# U_B_2_U_C_End_dy     = U_C_End_y



# U_S = ax_u_l.add_patch(plt.Arrow(U_S_Start_x,U_S_Start_y,U_S_End_x,U_S_End_y, width = 0.05, color = 'b'))


# U_A = ax.add_patch(plt.Arrow(U_A_Start_x,U_A_Start_y,U_A_End_x,U_A_End_y, width = 0.05, color = 'g'))
# U_B = ax.add_patch(plt.Arrow(U_B_Start_x,U_B_Start_y,U_B_End_x,U_B_End_y, width = 0.05, color = 'r'))
# U_C = ax.add_patch(plt.Arrow(U_C_Start_x,U_C_Start_y,U_C_End_x,U_C_End_y, width = 0.05, color = 'c'))
# U_alpha = ax.add_patch(plt.Arrow(U_alpha_Start_x,U_alpha_Start_y,U_alpha_End_x,U_alpha_End_y, width = 0.05, color = 'r'))
# U_beta = ax.add_patch(plt.Arrow(U_beta_Start_x,U_beta_Start_y,U_beta_End_x,U_beta_End_y, width = 0.05, color = 'c'))
# U_A_2_U_B = ax.add_patch(plt.Arrow(U_A_2_U_B_Start_x,U_A_2_U_B_Start_y,U_A_2_U_B_End_dx,U_A_2_U_B_End_dy, width = 0.05, color = 'm'))
# U_B_2_U_C = ax.add_patch(plt.Arrow(U_B_2_U_C_Start_x,U_B_2_U_C_Start_y,U_B_2_U_C_End_dx,U_B_2_U_C_End_dy, width = 0.05, color = 'y'))
# print("U_B_2_U_C_Start_x = ",U_B_2_U_C_Start_x)
# print("U_B_2_U_C_Start_y = ",U_B_2_U_C_Start_y)
# print("U_B_2_U_C_End_x   = ",U_B_2_U_C_End_x)
# print("U_B_2_U_C_End_y   = ",U_B_2_U_C_End_y)
# U_S = ax.plot(U_S_Start_x,U_S_Start_y,U_S_End_x,U_S_End_y, color = 'b')
# U_A = ax.plot(U_A_Start_x,U_A_Start_y,U_A_End_x,U_A_End_y, color = 'g')
# U_B = ax.plot(U_B_Start_x,U_B_Start_y,U_B_End_x,U_B_End_y, color = 'r')
# U_C = ax.plot(U_C_Start_x,U_C_Start_y,U_C_End_x,U_C_End_y, color = 'c')
# U_A_2_U_B = ax.plot(U_A_2_U_B_Start_x,U_A_2_U_B_Start_y,U_A_2_U_B_End_x,U_A_2_U_B_End_y, color = 'm')
# U_B_2_U_C = ax.plot(U_B_2_U_C_Start_x,U_B_2_U_C_Start_y,U_B_2_U_C_End_x,U_B_2_U_C_End_y, color = 'y')

plt.grid()
plt.show()
```

    N =  3
    sector =  1
    T_1_temp =  1.9746542181734927e-05
    T_2_temp =  3.7111359948427954e-05
    T_1 =  1.736481776669304e-05
    T_2 =  3.2635182233306965e-05
    T_0 =  0.0
    U_4 =  0.00013891854213354433
    


```python

from matplotlib import pyplot as plt
from mpl_toolkits.mplot3d import Axes3D  
import numpy as np

fig = plt.figure()
ax1 = plt.axes(projection="3d")

x = np.arange(-5,5,0.1)
y = np.arange(-5,5,0.1)
Z = x**2+y**2

ax1.plot3D(x,y,Z,"gray")
plt.show()


```


    
![png](output_3_0.png)
    



```python
import numpy as np
import matplotlib
from matplotlib import pyplot as plt
from mpl_toolkits.mplot3d import Axes3D   
matplotlib.use('TkAgg') # works good outside jupyter note book restart kernal first


plt.figure()
ax = plt.axes(projection="3d")

x = np.arange(-5,5,0.1)
y = np.arange(-5,5,0.1)
X,Y = np.meshgrid(x,y)    # 2生成绘制3D图形所需的网络数据
Z = X**2+Y**2

ax.plot_surface(X,Y,Z,alpha=0.5,cmap="winter") #生成表面，alpha用于控制透明度
#ax.contour(X,Y,Z,zdir="x",offset=-6,cmap="rainbow")   #x轴投影
#ax.contour(X,Y,Z,zdir="y",offset=6,cmap="rainbow")    #y轴投影
#ax.contour(X,Y,Z,zdir="z",offset=-3,cmap="rainbow")   #z轴投影
ax.set_xlabel("X")  #设置X、Y、Z 坐标范围
ax.set_xlim(-6,6)   #设置X、Y、Z 轴
ax.set_ylabel("Y")
ax.set_ylim(-6,6)
ax.set_zlabel("Z")
plt.show()

```


    
![png](output_4_0.png)
    



```python
import numpy as np
import matplotlib
from matplotlib import pyplot as plt
from mpl_toolkits.mplot3d import Axes3D   
from sympy import *
# matplotlib.use('TkAgg') # works good outside jupyter note book restart kernal first
# I_d=np.arange(-10,10,0.01)
# I_q=np.arange(-10,10,0.01)
I_d=symbols('I_d')
I_q=symbols('I_q')
L_d=0.01
L_q=0.015
Torque=10
psi=10
p=4
# Torque=1.5*p*(psi*I_q+(L_d-L_q)*I_d*I_q)
eq1=simplify(1.5*p*(psi*I_q+(L_d-L_q)*I_d*I_q)-Torque)
print("eq1 = ",eq1)
solve(1.5*p*(psi*I_q+(L_d-L_q)*I_d*I_q)-Torque,I_q)
# print("I_d = ",I_d)
# print("I_q = ",I_q)
I_d=np.arange(-10,10,0.01)
plt.figure()
# ax = plt.axes()
plt(I_d,-1000/(3*I_d-6000))
plt.show()
```

    eq1 =  -0.03*I_d*I_q + 60.0*I_q - 10
    


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    Cell In [34], line 25
         23 plt.figure()
         24 # ax = plt.axes()
    ---> 25 plt(I_d,-1000/(3*I_d-6000))
         26 plt.show()
    

    TypeError: 'module' object is not callable



    <Figure size 432x288 with 0 Axes>



```python
import matplotlib.pyplot as plt
import numpy as np
import matplotlib
matplotlib.use('TkAgg') # works good outside jupyter note book restart kernal first
# plt.style.use('_mpl-gallery')

# make data
I_d = np.linspace(-100, 100, 10000)
I_q = -1000/(3*I_d-6000)

# plot
fig, ax = plt.subplots()

ax.plot(I_d, I_q, linewidth=2.0)

# ax.set(xlim=(0, 8), xticks=np.arange(1, 8),
#        ylim=(0, 8), yticks=np.arange(1, 8))

plt.show()
```


    
![png](output_6_0.png)
    



```python
x
```




    array([ 0.        ,  0.1010101 ,  0.2020202 ,  0.3030303 ,  0.4040404 ,
            0.50505051,  0.60606061,  0.70707071,  0.80808081,  0.90909091,
            1.01010101,  1.11111111,  1.21212121,  1.31313131,  1.41414141,
            1.51515152,  1.61616162,  1.71717172,  1.81818182,  1.91919192,
            2.02020202,  2.12121212,  2.22222222,  2.32323232,  2.42424242,
            2.52525253,  2.62626263,  2.72727273,  2.82828283,  2.92929293,
            3.03030303,  3.13131313,  3.23232323,  3.33333333,  3.43434343,
            3.53535354,  3.63636364,  3.73737374,  3.83838384,  3.93939394,
            4.04040404,  4.14141414,  4.24242424,  4.34343434,  4.44444444,
            4.54545455,  4.64646465,  4.74747475,  4.84848485,  4.94949495,
            5.05050505,  5.15151515,  5.25252525,  5.35353535,  5.45454545,
            5.55555556,  5.65656566,  5.75757576,  5.85858586,  5.95959596,
            6.06060606,  6.16161616,  6.26262626,  6.36363636,  6.46464646,
            6.56565657,  6.66666667,  6.76767677,  6.86868687,  6.96969697,
            7.07070707,  7.17171717,  7.27272727,  7.37373737,  7.47474747,
            7.57575758,  7.67676768,  7.77777778,  7.87878788,  7.97979798,
            8.08080808,  8.18181818,  8.28282828,  8.38383838,  8.48484848,
            8.58585859,  8.68686869,  8.78787879,  8.88888889,  8.98989899,
            9.09090909,  9.19191919,  9.29292929,  9.39393939,  9.49494949,
            9.5959596 ,  9.6969697 ,  9.7979798 ,  9.8989899 , 10.        ])






```python
from control_block_diagram import ControllerDiagram
from control_block_diagram import Point, Box, Connection


if __name__ == '__main__':
    doc = ControllerDiagram()
    
    box_control = Box(Point(0, 0), text='Control')
    box_block = Box(box_control.position.add_x(3), text='Block')
    box_diagram = Box(box_block.position.add_x(3), text='Diagram')

    Connection.connect(box_control.output, box_block.input)
    Connection.connect(box_block.output, box_diagram.input)
    
    doc.save('pdf')
    doc.show()
```


    ---------------------------------------------------------------------------

    CompilerError                             Traceback (most recent call last)

    Cell In [3], line 15
         12 Connection.connect(box_control.output, box_block.input)
         13 Connection.connect(box_block.output, box_diagram.input)
    ---> 15 doc.save('pdf')
         16 doc.show()
    

    File c:\d\ic\tle9879\control-block-diagram\control_block_diagram\control_diagram.py:97, in ControllerDiagram.save(self, *data_type)
         95 name, data_type = filename.rsplit('.', 1)
         96 if data_type == 'pdf':
    ---> 97     self._doc.generate_pdf(name, compiler='pdflatex', clean_tex=self._clean_tex)
         98     self._pdf_name = filename
         99 elif data_type == 'tex' and 'pdf' not in self._data_type:
    

    File c:\Users\j4000774\AppData\Local\Programs\Python\Python310\lib\site-packages\pylatex-1.4.1-py3.10.egg\pylatex\document.py:298, in Document.generate_pdf(self, filepath, clean, clean_tex, compiler, compiler_args, silent)
        294     break
        296 else:
        297     # Notify user that none of the compilers worked.
    --> 298     raise(CompilerError(
        299         'No LaTex compiler was found\n'
        300         'Either specify a LaTex compiler '
        301         'or make sure you have latexmk or pdfLaTex installed.'
        302     ))
        304 if not python_cwd_available:
        305     os.chdir(cur_dir)
    

    CompilerError: No LaTex compiler was found
    Either specify a LaTex compiler or make sure you have latexmk or pdfLaTex installed.

